{"ast":null,"code":"import React from 'react';\nimport axios from 'axios';\nexport const config = () => {\n  return {\n    authorization: \"Bearer \" + localStorage.getItem('jwt')\n  };\n};\n\nconst apiRequest = ({\n  method,\n  endpoint,\n  headers,\n  params,\n  data,\n  setCookie = false\n}) => {\n  console.log(\"Set cookie:\", setCookie);\n  return new Promise((resolve, reject) => {\n    axios({\n      method,\n      url: endpoint,\n      headers: headers,\n      params,\n      data\n    }).then(resp => {\n      if (resp.data && !resp.data.error) {\n        resolve(resp.data);\n      } else {\n        if (resp.status >= 500 && resp.status <= 599) {\n          reject(\"Something went wrong.\");\n        }\n\n        if (setCookie) {\n          console.log(\"Response:\", resp);\n          const cookies = response.headers['set-cookie'];\n          console.log(\"Cookies:\", cookies);\n        } // if (error.code === 0) {\n        //   resolve(data);\n        // } else {\n        //   reject(error.message || \"Request Failed\");\n        // }\n\n\n        if (resp.data.error) {\n          reject(resp.data.error || \"Request Failed\");\n        }\n      }\n    }).catch(err => {\n      if (err.status >= 500 && err.status <= 599) {\n        reject(\"Something went wrong.\");\n      }\n\n      const errorResponse = err && err.response || {};\n\n      if (errorResponse.status === 401) {\n        localStorage.clear();\n        sessionStorage.clear();\n        window.location.reload();\n        reject(errorResponse.statusText || errorResponse || \"Failed Request\");\n      } // if (errorResponse.data && errorResponse.data.message) {\n      //   reject(errorResponse.data.message);\n      // } else {\n      //   reject(errorResponse.statusText);\n      // }\n      else {\n        reject(\n        /*errorResponse.statusText || errorResponse.data.message || errorResponse ||*/\n        \"Failed Request\");\n      }\n    });\n  });\n};\n\nexport default apiRequest;","map":{"version":3,"sources":["/home/soumyajit/Personal_Projects/topgram-app/frontend/src/service/request.js"],"names":["React","axios","config","authorization","localStorage","getItem","apiRequest","method","endpoint","headers","params","data","setCookie","console","log","Promise","resolve","reject","url","then","resp","error","status","cookies","response","catch","err","errorResponse","clear","sessionStorage","window","location","reload","statusText"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,MAAM,GAAG,MAAM;AAC3B,SAAO;AACLC,IAAAA,aAAa,EAAE,YAAYC,YAAY,CAACC,OAAb,CAAqB,KAArB;AADtB,GAAP;AAGA,CAJM;;AAMP,MAAMC,UAAU,GAAG,CAAC;AAACC,EAAAA,MAAD;AAASC,EAAAA,QAAT;AAAmBC,EAAAA,OAAnB;AAA4BC,EAAAA,MAA5B;AAAoCC,EAAAA,IAApC;AAA0CC,EAAAA,SAAS,GAAG;AAAtD,CAAD,KAAkE;AACnFC,EAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,SAA3B;AACE,SAAO,IAAIG,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpChB,IAAAA,KAAK,CAAC;AACJM,MAAAA,MADI;AAEJW,MAAAA,GAAG,EAAEV,QAFD;AAGJC,MAAAA,OAAO,EAAEA,OAHL;AAIJC,MAAAA,MAJI;AAKJC,MAAAA;AALI,KAAD,CAAL,CAOGQ,IAPH,CAOSC,IAAD,IAAU;AACd,UAAGA,IAAI,CAACT,IAAL,IAAa,CAACS,IAAI,CAACT,IAAL,CAAUU,KAA3B,EAAiC;AAC7BL,QAAAA,OAAO,CAACI,IAAI,CAACT,IAAN,CAAP;AACH,OAFD,MAGK;AACD,YAAIS,IAAI,CAACE,MAAL,IAAe,GAAf,IAAsBF,IAAI,CAACE,MAAL,IAAe,GAAzC,EAA8C;AAC9CL,UAAAA,MAAM,CAAC,uBAAD,CAAN;AACC;;AACD,YAAGL,SAAH,EAAc;AACZC,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBM,IAAzB;AACA,gBAAMG,OAAO,GAAGC,QAAQ,CAACf,OAAT,CAAiB,YAAjB,CAAhB;AACAI,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBS,OAAxB;AACD,SARA,CASD;AACA;AACA;AACA;AACA;;;AACA,YAAGH,IAAI,CAACT,IAAL,CAAUU,KAAb,EAAmB;AACfJ,UAAAA,MAAM,CAACG,IAAI,CAACT,IAAL,CAAUU,KAAV,IAAmB,gBAApB,CAAN;AACH;AACJ;AACF,KA7BH,EA8BGI,KA9BH,CA8BUC,GAAD,IAAS;AACd,UAAIA,GAAG,CAACJ,MAAJ,IAAc,GAAd,IAAqBI,GAAG,CAACJ,MAAJ,IAAc,GAAvC,EAA4C;AAC1CL,QAAAA,MAAM,CAAC,uBAAD,CAAN;AACD;;AACD,YAAMU,aAAa,GAAID,GAAG,IAAIA,GAAG,CAACF,QAAZ,IAAyB,EAA/C;;AACA,UAAIG,aAAa,CAACL,MAAd,KAAyB,GAA7B,EAAkC;AAChClB,QAAAA,YAAY,CAACwB,KAAb;AACAC,QAAAA,cAAc,CAACD,KAAf;AACAE,QAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACAf,QAAAA,MAAM,CAACU,aAAa,CAACM,UAAd,IAA4BN,aAA5B,IAA6C,gBAA9C,CAAN;AACD,OALD,CAMA;AACA;AACA;AACA;AACA;AAVA,WAWK;AACDV,QAAAA,MAAM;AAAC;AAA+E,wBAAhF,CAAN;AACH;AACF,KAjDH;AAkDD,GAnDI,CAAP;AAoDH,CAtDD;;AAwDA,eAAeX,UAAf","sourcesContent":["import React from 'react';\nimport axios from 'axios';\n\nexport const config = () => {\n\treturn {\n\t\t\tauthorization: \"Bearer \" + localStorage.getItem('jwt'),\n\t};\n};\n\nconst apiRequest = ({method, endpoint, headers, params, data, setCookie = false}) => {\n  console.log(\"Set cookie:\", setCookie)\n    return new Promise((resolve, reject) => {\n        axios({\n          method,\n          url: endpoint,\n          headers: headers,\n          params,\n          data,\n        })\n          .then((resp) => {\n            if(resp.data && !resp.data.error){\n                resolve(resp.data);\n            }\n            else {\n                if (resp.status >= 500 && resp.status <= 599) {\n                reject(\"Something went wrong.\");\n                }\n                if(setCookie) {\n                  console.log(\"Response:\", resp);\n                  const cookies = response.headers['set-cookie'];\n                  console.log(\"Cookies:\", cookies)\n                }\n                // if (error.code === 0) {\n                //   resolve(data);\n                // } else {\n                //   reject(error.message || \"Request Failed\");\n                // }\n                if(resp.data.error){\n                    reject(resp.data.error || \"Request Failed\");\n                }\n            }\n          })\n          .catch((err) => {\n            if (err.status >= 500 && err.status <= 599) {\n              reject(\"Something went wrong.\");\n            }\n            const errorResponse = (err && err.response) || {};\n            if (errorResponse.status === 401) {\n              localStorage.clear();\n              sessionStorage.clear();\n              window.location.reload();\n              reject(errorResponse.statusText || errorResponse || \"Failed Request\");\n            }\n            // if (errorResponse.data && errorResponse.data.message) {\n            //   reject(errorResponse.data.message);\n            // } else {\n            //   reject(errorResponse.statusText);\n            // }\n            else {\n                reject(/*errorResponse.statusText || errorResponse.data.message || errorResponse ||*/ \"Failed Request\");\n            }\n          });\n      });\n}\n\nexport default apiRequest"]},"metadata":{},"sourceType":"module"}