{"ast":null,"code":"import React from 'react';\nimport axios from 'axios';\nexport const config = () => {\n  return {\n    authorization: \"Bearer \" + localStorage.getItem('jwt')\n  };\n};\n\nconst apiRequest = ({\n  method,\n  endpoint,\n  headers,\n  params,\n  data,\n  setCookie = false\n}) => {\n  console.log(\"Set cookie:\", setCookie);\n  return new Promise((resolve, reject) => {\n    axios({\n      method,\n      url: endpoint,\n      headers: headers,\n      params,\n      data,\n      withCredentials: true // Include cookies in the request\n\n    }).then(resp => {\n      if (resp.data && !resp.data.error) {\n        resolve(resp.data);\n      } else {\n        if (resp.status >= 500 && resp.status <= 599) {\n          reject(\"Something went wrong.\");\n        } // if (error.code === 0) {\n        //   resolve(data);\n        // } else {\n        //   reject(error.message || \"Request Failed\");\n        // }\n\n\n        if (resp.data.error) {\n          reject(resp.data.error || \"Request Failed\");\n        }\n      }\n    }).catch(err => {\n      if (err.status >= 500 && err.status <= 599) {\n        reject(\"Something went wrong.\");\n      }\n\n      const errorResponse = err && err.response || {};\n\n      if (errorResponse.status === 401) {\n        localStorage.clear();\n        sessionStorage.clear();\n        window.location.reload();\n        reject(errorResponse.statusText || errorResponse || \"Failed Request\");\n      } // if (errorResponse.data && errorResponse.data.message) {\n      //   reject(errorResponse.data.message);\n      // } else {\n      //   reject(errorResponse.statusText);\n      // }\n      else {\n        reject(\n        /*errorResponse.statusText || errorResponse.data.message || errorResponse ||*/\n        \"Failed Request\");\n      }\n    });\n  });\n};\n\nexport default apiRequest;","map":{"version":3,"sources":["/home/soumyajit/Personal_Projects/topgram-app/frontend/src/service/request.js"],"names":["React","axios","config","authorization","localStorage","getItem","apiRequest","method","endpoint","headers","params","data","setCookie","console","log","Promise","resolve","reject","url","withCredentials","then","resp","error","status","catch","err","errorResponse","response","clear","sessionStorage","window","location","reload","statusText"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,MAAM,GAAG,MAAM;AAC3B,SAAO;AACLC,IAAAA,aAAa,EAAE,YAAYC,YAAY,CAACC,OAAb,CAAqB,KAArB;AADtB,GAAP;AAGA,CAJM;;AAMP,MAAMC,UAAU,GAAG,CAAC;AAACC,EAAAA,MAAD;AAASC,EAAAA,QAAT;AAAmBC,EAAAA,OAAnB;AAA4BC,EAAAA,MAA5B;AAAoCC,EAAAA,IAApC;AAA0CC,EAAAA,SAAS,GAAG;AAAtD,CAAD,KAAkE;AACnFC,EAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,SAA3B;AACE,SAAO,IAAIG,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpChB,IAAAA,KAAK,CAAC;AACJM,MAAAA,MADI;AAEJW,MAAAA,GAAG,EAAEV,QAFD;AAGJC,MAAAA,OAAO,EAAEA,OAHL;AAIJC,MAAAA,MAJI;AAKJC,MAAAA,IALI;AAMJQ,MAAAA,eAAe,EAAE,IANb,CAMkB;;AANlB,KAAD,CAAL,CAQGC,IARH,CAQSC,IAAD,IAAU;AACd,UAAGA,IAAI,CAACV,IAAL,IAAa,CAACU,IAAI,CAACV,IAAL,CAAUW,KAA3B,EAAiC;AAC7BN,QAAAA,OAAO,CAACK,IAAI,CAACV,IAAN,CAAP;AACH,OAFD,MAGK;AACD,YAAIU,IAAI,CAACE,MAAL,IAAe,GAAf,IAAsBF,IAAI,CAACE,MAAL,IAAe,GAAzC,EAA8C;AAC9CN,UAAAA,MAAM,CAAC,uBAAD,CAAN;AACC,SAHA,CAID;AACA;AACA;AACA;AACA;;;AACA,YAAGI,IAAI,CAACV,IAAL,CAAUW,KAAb,EAAmB;AACfL,UAAAA,MAAM,CAACI,IAAI,CAACV,IAAL,CAAUW,KAAV,IAAmB,gBAApB,CAAN;AACH;AACJ;AACF,KAzBH,EA0BGE,KA1BH,CA0BUC,GAAD,IAAS;AACd,UAAIA,GAAG,CAACF,MAAJ,IAAc,GAAd,IAAqBE,GAAG,CAACF,MAAJ,IAAc,GAAvC,EAA4C;AAC1CN,QAAAA,MAAM,CAAC,uBAAD,CAAN;AACD;;AACD,YAAMS,aAAa,GAAID,GAAG,IAAIA,GAAG,CAACE,QAAZ,IAAyB,EAA/C;;AACA,UAAID,aAAa,CAACH,MAAd,KAAyB,GAA7B,EAAkC;AAChCnB,QAAAA,YAAY,CAACwB,KAAb;AACAC,QAAAA,cAAc,CAACD,KAAf;AACAE,QAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACAf,QAAAA,MAAM,CAACS,aAAa,CAACO,UAAd,IAA4BP,aAA5B,IAA6C,gBAA9C,CAAN;AACD,OALD,CAMA;AACA;AACA;AACA;AACA;AAVA,WAWK;AACDT,QAAAA,MAAM;AAAC;AAA+E,wBAAhF,CAAN;AACH;AACF,KA7CH;AA8CD,GA/CI,CAAP;AAgDH,CAlDD;;AAoDA,eAAeX,UAAf","sourcesContent":["import React from 'react';\nimport axios from 'axios';\n\nexport const config = () => {\n\treturn {\n\t\t\tauthorization: \"Bearer \" + localStorage.getItem('jwt'),\n\t};\n};\n\nconst apiRequest = ({method, endpoint, headers, params, data, setCookie = false}) => {\n  console.log(\"Set cookie:\", setCookie)\n    return new Promise((resolve, reject) => {\n        axios({\n          method,\n          url: endpoint,\n          headers: headers,\n          params,\n          data,\n          withCredentials: true // Include cookies in the request\n        })\n          .then((resp) => {\n            if(resp.data && !resp.data.error){\n                resolve(resp.data);\n            }\n            else {\n                if (resp.status >= 500 && resp.status <= 599) {\n                reject(\"Something went wrong.\");\n                }\n                // if (error.code === 0) {\n                //   resolve(data);\n                // } else {\n                //   reject(error.message || \"Request Failed\");\n                // }\n                if(resp.data.error){\n                    reject(resp.data.error || \"Request Failed\");\n                }\n            }\n          })\n          .catch((err) => {\n            if (err.status >= 500 && err.status <= 599) {\n              reject(\"Something went wrong.\");\n            }\n            const errorResponse = (err && err.response) || {};\n            if (errorResponse.status === 401) {\n              localStorage.clear();\n              sessionStorage.clear();\n              window.location.reload();\n              reject(errorResponse.statusText || errorResponse || \"Failed Request\");\n            }\n            // if (errorResponse.data && errorResponse.data.message) {\n            //   reject(errorResponse.data.message);\n            // } else {\n            //   reject(errorResponse.statusText);\n            // }\n            else {\n                reject(/*errorResponse.statusText || errorResponse.data.message || errorResponse ||*/ \"Failed Request\");\n            }\n          });\n      });\n}\n\nexport default apiRequest"]},"metadata":{},"sourceType":"module"}