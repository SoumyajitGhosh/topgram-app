{"ast":null,"code":"var _jsxFileName = \"/home/soumyajit/Personal_Projects/topgram-app/frontend/src/screens/CreatePost.jsx\",\n    _s = $RefreshSig$();\n\n/**\n *\n * @author Anass Ferrak aka \" TheLordA \" <ferrak.anass@gmail.com>\n * GitHub repo: https://github.com/TheLordA/Instagram-Clone\n *\n */\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport makeStyles from '@mui/styles/makeStyles';\nimport Axios from \"axios\";\nimport { CREATE_POST_URL } from \"../service/apiCalls\";\nimport Navbar from \"../components/Navbar\"; // Material-UI deps\n\nimport Stepper from \"@mui/material/Stepper\";\nimport Step from \"@mui/material/Step\";\nimport StepLabel from \"@mui/material/StepLabel\";\nimport StepContent from \"@mui/material/StepContent\";\nimport Button from \"@mui/material/Button\";\nimport Paper from \"@mui/material/Paper\";\nimport Typography from \"@mui/material/Typography\";\nimport TextField from \"@mui/material/TextField\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport Fade from \"@mui/material/Fade\";\nimport Alert from '@mui/material/Alert'; // FilePond deps\n\nimport { FilePond, registerPlugin } from \"react-filepond\";\nimport \"filepond/dist/filepond.min.css\";\nimport FilePondPluginImagePreview from \"filepond-plugin-image-preview\";\nimport \"filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.css\";\nimport FilePondPluginFileEncode from \"filepond-plugin-file-encode\";\nimport FilePondPluginImageResize from \"filepond-plugin-image-resize\";\nimport FilePondPluginImageTransform from \"filepond-plugin-image-transform\";\nimport FilePondPluginFileValidateType from \"filepond-plugin-file-validate-type\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nregisterPlugin(FilePondPluginImagePreview, FilePondPluginFileEncode, FilePondPluginImageResize, FilePondPluginImageTransform, FilePondPluginFileValidateType); // General Style\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: \"70%\",\n    margin: \"40px auto\"\n  },\n  filesContainer: {\n    maxWidth: \"500px\",\n    margin: \"auto\"\n  },\n  button: {\n    marginTop: theme.spacing(1),\n    marginRight: theme.spacing(1)\n  },\n  actionsContainer: {\n    width: \"30%\",\n    margin: \"auto\",\n    marginBottom: theme.spacing(2)\n  },\n  resetContainer: {\n    padding: \"6px 24px\"\n  },\n  TextField: {\n    margin: \"10px 0px\"\n  },\n  reviewRoot: {\n    maxWidth: 400,\n    flexGrow: 1,\n    margin: \"10px auto\"\n  },\n  reviewImg: {\n    height: 255,\n    display: \"block\",\n    maxWidth: 400,\n    overflow: \"hidden\",\n    width: \"100%\"\n  },\n  reviewBottom: {\n    display: \"flex\",\n    alignItems: \"center\",\n    height: 50,\n    paddingLeft: theme.spacing(4),\n    backgroundColor: theme.palette.background.default\n  },\n  finishStyle: {\n    width: \"fit-content\",\n    margin: \"auto\"\n  }\n}));\n\nconst getSteps = () => {\n  return [\"Select you image\", \"Tag a Friend\", \"Submit the post\"];\n};\n\nconst CreatePoste = () => {\n  _s();\n\n  const classes = useStyles();\n  const history = useNavigate();\n  const [files, setFiles] = useState([]);\n  const [caption, setCaption] = useState(\"\");\n  const [activeStep, setActiveStep] = useState(0);\n  const steps = getSteps();\n  const [query, setQuery] = useState(\"idle\");\n  const timerRef = useRef();\n  const config = axiosConfig(localStorage.getItem(\"jwt\"));\n  useEffect(() => () => {\n    clearTimeout(timerRef.current);\n  }, []);\n\n  const handlePostData = () => {\n    // the Index 0 means the first file , we will add in the future the support of multiple\n    // images upload , the max will be 10 images per post\n    const photoEncode = files[0].getFileEncodeBase64String();\n    const photoType = files[0].fileType;\n    Axios.post(CREATE_POST_URL, {\n      title: caption,\n      body: caption,\n      photoEncode,\n      photoType\n    }, config).then(rep => {\n      if (rep.data.message) {\n        setQuery(\"success\");\n      }\n    });\n  };\n\n  const getStepContent = step => {\n    switch (step) {\n      case 0:\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.filesContainer,\n          children: [/*#__PURE__*/_jsxDEV(FilePond, {\n            labelIdle: \"Drag & Drop your picture or <span class=\\\"filepond--label-action\\\">Browse</span>\",\n            files: files,\n            allowMultiple: false,\n            onupdatefiles: setFiles,\n            imageResizeTargetWidth: 450,\n            imageResizeTargetHeight: 450,\n            acceptedFileTypes: [\"image/jpeg\", \"image/png\", \"images/gif\"],\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            className: classes.TextField,\n            id: \"outlined-search\",\n            label: \"Caption\",\n            type: \"text\",\n            variant: \"outlined\",\n            fullWidth: \"true\",\n            multiline: \"true\",\n            value: caption,\n            onChange: e => setCaption(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 6\n        }, this);\n\n      case 1:\n        return \"This functionality isn't available for the moment\";\n\n      case 2:\n        return;\n\n      default:\n        return \"Unknown step\";\n    }\n  };\n\n  const handleNext = () => {\n    setActiveStep(prevActiveStep => prevActiveStep + 1);\n  };\n\n  const handleBack = () => {\n    setActiveStep(prevActiveStep => prevActiveStep - 1);\n  };\n\n  const handleClickQuery = () => {\n    clearTimeout(timerRef.current);\n\n    if (query !== \"idle\") {\n      setQuery(\"idle\");\n      return;\n    }\n\n    setQuery(\"progress\");\n    timerRef.current = setTimeout(() => {\n      history(\"/\");\n    }, 4000);\n  };\n\n  const handleSubmit = () => {\n    handleNext();\n    handleClickQuery();\n    handlePostData();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.root,\n      children: /*#__PURE__*/_jsxDEV(Stepper, {\n        component: Paper,\n        elevation: 3,\n        activeStep: activeStep,\n        orientation: \"vertical\",\n        children: [steps.map((label, index) => /*#__PURE__*/_jsxDEV(Step, {\n          children: [/*#__PURE__*/_jsxDEV(StepLabel, {\n            children: label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 8\n          }, this), /*#__PURE__*/_jsxDEV(StepContent, {\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              children: getStepContent(index)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: classes.actionsContainer,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  disabled: activeStep === 0,\n                  onClick: handleBack,\n                  className: classes.button,\n                  children: \"Back\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 11\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  disabled: files.length === 0 || caption === \"\",\n                  variant: \"contained\",\n                  color: \"primary\",\n                  onClick: activeStep === steps.length - 1 ? handleSubmit : handleNext,\n                  className: classes.button,\n                  children: activeStep === steps.length - 1 ? \"Submit\" : \"Next\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 219,\n                  columnNumber: 11\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 10\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 8\n          }, this)]\n        }, label, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 7\n        }, this)), activeStep === steps.length && /*#__PURE__*/_jsxDEV(Paper, {\n          square: true,\n          elevation: 0,\n          className: classes.resetContainer,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.finishStyle,\n            children: query === \"success\" ? /*#__PURE__*/_jsxDEV(Alert, {\n              variant: \"outlined\",\n              severity: \"success\",\n              children: \"Your post has been successfully submitted \\u2014 check it out!\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 10\n            }, this) : /*#__PURE__*/_jsxDEV(Fade, {\n              className: classes.finishStyle,\n              in: query === \"progress\",\n              style: {\n                transitionDelay: query === \"progress\" ? \"100ms\" : \"0ms\"\n              },\n              unmountOnExit: true,\n              children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 11\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n\n_s(CreatePoste, \"ju1C4jAFd2YG3IlycqWqwmdpXiQ=\", false, function () {\n  return [useStyles, useNavigate];\n});\n\n_c = CreatePoste;\nexport default CreatePoste;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreatePoste\");","map":{"version":3,"sources":["/home/soumyajit/Personal_Projects/topgram-app/frontend/src/screens/CreatePost.jsx"],"names":["React","useState","useEffect","useRef","useNavigate","makeStyles","Axios","CREATE_POST_URL","Navbar","Stepper","Step","StepLabel","StepContent","Button","Paper","Typography","TextField","CircularProgress","Fade","Alert","FilePond","registerPlugin","FilePondPluginImagePreview","FilePondPluginFileEncode","FilePondPluginImageResize","FilePondPluginImageTransform","FilePondPluginFileValidateType","useStyles","theme","root","width","margin","filesContainer","maxWidth","button","marginTop","spacing","marginRight","actionsContainer","marginBottom","resetContainer","padding","reviewRoot","flexGrow","reviewImg","height","display","overflow","reviewBottom","alignItems","paddingLeft","backgroundColor","palette","background","default","finishStyle","getSteps","CreatePoste","classes","history","files","setFiles","caption","setCaption","activeStep","setActiveStep","steps","query","setQuery","timerRef","config","axiosConfig","localStorage","getItem","clearTimeout","current","handlePostData","photoEncode","getFileEncodeBase64String","photoType","fileType","post","title","body","then","rep","data","message","getStepContent","step","e","target","value","handleNext","prevActiveStep","handleBack","handleClickQuery","setTimeout","handleSubmit","map","label","index","length","transitionDelay"],"mappings":"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","sourcesContent":["/**\n *\n * @author Anass Ferrak aka \" TheLordA \" <ferrak.anass@gmail.com>\n * GitHub repo: https://github.com/TheLordA/Instagram-Clone\n *\n */\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport makeStyles from '@mui/styles/makeStyles';\nimport Axios from \"axios\";\nimport { CREATE_POST_URL } from \"../service/apiCalls\"\nimport Navbar from \"../components/Navbar\";\n\n// Material-UI deps\nimport Stepper from \"@mui/material/Stepper\";\nimport Step from \"@mui/material/Step\";\nimport StepLabel from \"@mui/material/StepLabel\";\nimport StepContent from \"@mui/material/StepContent\";\nimport Button from \"@mui/material/Button\";\nimport Paper from \"@mui/material/Paper\";\nimport Typography from \"@mui/material/Typography\";\nimport TextField from \"@mui/material/TextField\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport Fade from \"@mui/material/Fade\";\nimport Alert from '@mui/material/Alert';\n// FilePond deps\nimport { FilePond, registerPlugin } from \"react-filepond\";\nimport \"filepond/dist/filepond.min.css\";\nimport FilePondPluginImagePreview from \"filepond-plugin-image-preview\";\nimport \"filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.css\";\nimport FilePondPluginFileEncode from \"filepond-plugin-file-encode\";\nimport FilePondPluginImageResize from \"filepond-plugin-image-resize\";\nimport FilePondPluginImageTransform from \"filepond-plugin-image-transform\";\nimport FilePondPluginFileValidateType from \"filepond-plugin-file-validate-type\";\n\nregisterPlugin(\n\tFilePondPluginImagePreview,\n\tFilePondPluginFileEncode,\n\tFilePondPluginImageResize,\n\tFilePondPluginImageTransform,\n\tFilePondPluginFileValidateType\n);\n\n// General Style\nconst useStyles = makeStyles((theme) => ({\n\troot: {\n\t\twidth: \"70%\",\n\t\tmargin: \"40px auto\",\n\t},\n\tfilesContainer: { maxWidth: \"500px\", margin: \"auto\" },\n\tbutton: {\n\t\tmarginTop: theme.spacing(1),\n\t\tmarginRight: theme.spacing(1),\n\t},\n\tactionsContainer: {\n\t\twidth: \"30%\",\n\t\tmargin: \"auto\",\n\t\tmarginBottom: theme.spacing(2),\n\t},\n\tresetContainer: {\n\t\tpadding: \"6px 24px\",\n\t},\n\tTextField: {\n\t\tmargin: \"10px 0px\",\n\t},\n\treviewRoot: {\n\t\tmaxWidth: 400,\n\t\tflexGrow: 1,\n\t\tmargin: \"10px auto\",\n\t},\n\treviewImg: {\n\t\theight: 255,\n\t\tdisplay: \"block\",\n\t\tmaxWidth: 400,\n\t\toverflow: \"hidden\",\n\t\twidth: \"100%\",\n\t},\n\treviewBottom: {\n\t\tdisplay: \"flex\",\n\t\talignItems: \"center\",\n\t\theight: 50,\n\t\tpaddingLeft: theme.spacing(4),\n\t\tbackgroundColor: theme.palette.background.default,\n\t},\n\tfinishStyle: {\n\t\twidth: \"fit-content\",\n\t\tmargin: \"auto\",\n\t},\n}));\n\nconst getSteps = () => {\n\treturn [\"Select you image\", \"Tag a Friend\", \"Submit the post\"];\n};\n\nconst CreatePoste = () => {\n\tconst classes = useStyles();\n\tconst history = useNavigate();\n\tconst [files, setFiles] = useState([]);\n\tconst [caption, setCaption] = useState(\"\");\n\tconst [activeStep, setActiveStep] = useState(0);\n\tconst steps = getSteps();\n\n\tconst [query, setQuery] = useState(\"idle\");\n\tconst timerRef = useRef();\n\n\tconst config = axiosConfig(localStorage.getItem(\"jwt\"));\n\n\tuseEffect(\n\t\t() => () => {\n\t\t\tclearTimeout(timerRef.current);\n\t\t},\n\t\t[]\n\t);\n\n\tconst handlePostData = () => {\n\t\t// the Index 0 means the first file , we will add in the future the support of multiple\n\t\t// images upload , the max will be 10 images per post\n\t\tconst photoEncode = files[0].getFileEncodeBase64String();\n\t\tconst photoType = files[0].fileType;\n\t\tAxios.post(\n\t\t\tCREATE_POST_URL,\n\t\t\t{\n\t\t\t\ttitle: caption,\n\t\t\t\tbody: caption,\n\t\t\t\tphotoEncode,\n\t\t\t\tphotoType,\n\t\t\t},\n\t\t\tconfig\n\t\t).then((rep) => {\n\t\t\tif (rep.data.message) {\n\t\t\t\tsetQuery(\"success\");\n\t\t\t}\n\t\t});\n\t};\n\n\tconst getStepContent = (step) => {\n\t\tswitch (step) {\n\t\t\tcase 0:\n\t\t\t\treturn (\n\t\t\t\t\t<div className={classes.filesContainer}>\n\t\t\t\t\t\t<FilePond\n\t\t\t\t\t\t\tlabelIdle='Drag & Drop your picture or <span class=\"filepond--label-action\">Browse</span>'\n\t\t\t\t\t\t\tfiles={files}\n\t\t\t\t\t\t\tallowMultiple={false}\n\t\t\t\t\t\t\tonupdatefiles={setFiles}\n\t\t\t\t\t\t\timageResizeTargetWidth={450}\n\t\t\t\t\t\t\timageResizeTargetHeight={450}\n\t\t\t\t\t\t\tacceptedFileTypes={[\"image/jpeg\", \"image/png\", \"images/gif\"]}\n\t\t\t\t\t\t\trequired={true}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tclassName={classes.TextField}\n\t\t\t\t\t\t\tid=\"outlined-search\"\n\t\t\t\t\t\t\tlabel=\"Caption\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tfullWidth=\"true\"\n\t\t\t\t\t\t\tmultiline=\"true\"\n\t\t\t\t\t\t\tvalue={caption}\n\t\t\t\t\t\t\tonChange={(e) => setCaption(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\tcase 1:\n\t\t\t\treturn \"This functionality isn't available for the moment\";\n\t\t\tcase 2:\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t\t\treturn \"Unknown step\";\n\t\t}\n\t};\n\n\tconst handleNext = () => {\n\t\tsetActiveStep((prevActiveStep) => prevActiveStep + 1);\n\t};\n\n\tconst handleBack = () => {\n\t\tsetActiveStep((prevActiveStep) => prevActiveStep - 1);\n\t};\n\n\tconst handleClickQuery = () => {\n\t\tclearTimeout(timerRef.current);\n\t\tif (query !== \"idle\") {\n\t\t\tsetQuery(\"idle\");\n\t\t\treturn;\n\t\t}\n\t\tsetQuery(\"progress\");\n\t\ttimerRef.current = setTimeout(() => {\n\t\t\thistory(\"/\");\n\t\t}, 4000);\n\t};\n\n\tconst handleSubmit = () => {\n\t\thandleNext();\n\t\thandleClickQuery();\n\t\thandlePostData();\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<Navbar />\n\t\t\t<div className={classes.root}>\n\t\t\t\t<Stepper component={Paper} elevation={3} activeStep={activeStep} orientation=\"vertical\">\n\t\t\t\t\t{steps.map((label, index) => (\n\t\t\t\t\t\t<Step key={label}>\n\t\t\t\t\t\t\t<StepLabel>{label}</StepLabel>\n\t\t\t\t\t\t\t<StepContent>\n\t\t\t\t\t\t\t\t<Typography>{getStepContent(index)}</Typography>\n\t\t\t\t\t\t\t\t<div className={classes.actionsContainer}>\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tdisabled={activeStep === 0}\n\t\t\t\t\t\t\t\t\t\t\tonClick={handleBack}\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.button}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tBack\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tdisabled={files.length === 0 || caption === \"\"}\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t\t\t\t\tactiveStep === steps.length - 1\n\t\t\t\t\t\t\t\t\t\t\t\t\t? handleSubmit\n\t\t\t\t\t\t\t\t\t\t\t\t\t: handleNext\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.button}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{activeStep === steps.length - 1 ? \"Submit\" : \"Next\"}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</StepContent>\n\t\t\t\t\t\t</Step>\n\t\t\t\t\t))}\n\t\t\t\t\t{activeStep === steps.length && (\n\t\t\t\t\t\t<Paper square elevation={0} className={classes.resetContainer}>\n\t\t\t\t\t\t\t<div className={classes.finishStyle}>\n\t\t\t\t\t\t\t\t{query === \"success\" ? (\n\t\t\t\t\t\t\t\t\t<Alert variant=\"outlined\" severity=\"success\">\n\t\t\t\t\t\t\t\t\t\tYour post has been successfully submitted — check it out!\n\t\t\t\t\t\t\t\t\t</Alert>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<Fade\n\t\t\t\t\t\t\t\t\t\tclassName={classes.finishStyle}\n\t\t\t\t\t\t\t\t\t\tin={query === \"progress\"}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\ttransitionDelay:\n\t\t\t\t\t\t\t\t\t\t\t\tquery === \"progress\" ? \"100ms\" : \"0ms\",\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tunmountOnExit\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<CircularProgress />\n\t\t\t\t\t\t\t\t\t</Fade>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Paper>\n\t\t\t\t\t)}\n\t\t\t\t</Stepper>\n\t\t\t</div>\n\t\t</>\n\t);\n};\n\nexport default CreatePoste;\n"]},"metadata":{},"sourceType":"module"}