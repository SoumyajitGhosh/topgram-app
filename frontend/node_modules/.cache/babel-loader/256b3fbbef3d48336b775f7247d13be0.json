{"ast":null,"code":"var _jsxFileName = \"/home/soumyajit/Personal_Projects/topgram-app/frontend/src/screens/CreatePost.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Axios from \"axios\";\nimport { CREATE_POST_URL } from \"../service/apiCalls\";\nimport Navbar from \"../components/Navbar\"; // Material-UI deps\n\nimport Stepper from \"@mui/material/Stepper\";\nimport Step from \"@mui/material/Step\";\nimport StepLabel from \"@mui/material/StepLabel\";\nimport StepContent from \"@mui/material/StepContent\";\nimport Button from \"@mui/material/Button\";\nimport Paper from \"@mui/material/Paper\";\nimport Typography from \"@mui/material/Typography\";\nimport TextField from \"@mui/material/TextField\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport Fade from \"@mui/material/Fade\";\nimport Alert from '@mui/material/Alert'; // FilePond deps\n\nimport { FilePond, registerPlugin } from \"react-filepond\";\nimport \"filepond/dist/filepond.min.css\";\nimport FilePondPluginImagePreview from \"filepond-plugin-image-preview\";\nimport \"filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.css\";\nimport FilePondPluginFileEncode from \"filepond-plugin-file-encode\";\nimport FilePondPluginImageResize from \"filepond-plugin-image-resize\";\nimport FilePondPluginImageTransform from \"filepond-plugin-image-transform\";\nimport FilePondPluginFileValidateType from \"filepond-plugin-file-validate-type\";\nimport { useTheme } from \"@mui/system\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nregisterPlugin(FilePondPluginImagePreview, FilePondPluginFileEncode, FilePondPluginImageResize, FilePondPluginImageTransform, FilePondPluginFileValidateType);\n\nconst getSteps = () => {\n  return [\"Select you image\", \"Tag a Friend\", \"Submit the post\"];\n};\n\nconst CreatePoste = () => {\n  _s();\n\n  const theme = useTheme();\n  const history = useNavigate();\n  const [files, setFiles] = useState([]);\n  const [caption, setCaption] = useState(\"\");\n  const [activeStep, setActiveStep] = useState(0);\n  const steps = getSteps();\n  const [query, setQuery] = useState(\"idle\");\n  const timerRef = useRef(); // const config = axiosConfig(localStorage.getItem(\"jwt\"));\n\n  useEffect(() => () => {\n    clearTimeout(timerRef.current);\n  }, []);\n\n  const handlePostData = () => {\n    // the Index 0 means the first file , we will add in the future the support of multiple\n    // images upload , the max will be 10 images per post\n    const photoEncode = files[0].getFileEncodeBase64String();\n    const photoType = files[0].fileType; // Axios.post(\n    // \tCREATE_POST_URL,\n    // \t{\n    // \t\ttitle: caption,\n    // \t\tbody: caption,\n    // \t\tphotoEncode,\n    // \t\tphotoType,\n    // \t},\n    // \tconfig\n    // ).then((rep) => {\n    // \tif (rep.data.message) {\n    // \t\tsetQuery(\"success\");\n    // \t}\n    // });\n\n    CREATE_POST_URL({\n      title: caption,\n      body: caption,\n      photoEncode,\n      photoType\n    }).then(rep => {\n      if (rep) {\n        setQuery(\"success\");\n      }\n    });\n  };\n\n  const getStepContent = step => {\n    switch (step) {\n      case 0:\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          sx: theme.filesContainer,\n          children: [/*#__PURE__*/_jsxDEV(FilePond, {\n            labelIdle: \"Drag & Drop your picture or <span class=\\\"filepond--label-action\\\">Browse</span>\",\n            files: files,\n            allowMultiple: false,\n            onupdatefiles: setFiles,\n            imageResizeTargetWidth: 450,\n            imageResizeTargetHeight: 450,\n            acceptedFileTypes: [\"image/jpeg\", \"image/png\", \"images/gif\"],\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            sx: {\n              margin: \"10px 0px\"\n            },\n            id: \"outlined-search\",\n            label: \"Caption\",\n            type: \"text\",\n            variant: \"outlined\",\n            fullWidth: \"true\",\n            multiline: \"true\",\n            value: caption,\n            onChange: e => setCaption(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 6\n        }, this);\n\n      case 1:\n        return \"This functionality isn't available for the moment\";\n\n      case 2:\n        return;\n\n      default:\n        return \"Unknown step\";\n    }\n  };\n\n  const handleNext = () => {\n    setActiveStep(prevActiveStep => prevActiveStep + 1);\n  };\n\n  const handleBack = () => {\n    setActiveStep(prevActiveStep => prevActiveStep - 1);\n  };\n\n  const handleClickQuery = () => {\n    clearTimeout(timerRef.current);\n\n    if (query !== \"idle\") {\n      setQuery(\"idle\");\n      return;\n    }\n\n    setQuery(\"progress\");\n    timerRef.current = setTimeout(() => {\n      history(\"/\");\n    }, 4000);\n  };\n\n  const handleSubmit = () => {\n    handleNext();\n    handleClickQuery();\n    handlePostData();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      sx: {\n        width: \"70%\",\n        margin: \"40px auto\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Stepper, {\n        component: Paper,\n        elevation: 3,\n        activeStep: activeStep,\n        orientation: \"vertical\",\n        children: [steps.map((label, index) => /*#__PURE__*/_jsxDEV(Step, {\n          children: [/*#__PURE__*/_jsxDEV(StepLabel, {\n            children: label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 8\n          }, this), /*#__PURE__*/_jsxDEV(StepContent, {\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              children: getStepContent(index)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              sx: theme.actionsContainer,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  disabled: activeStep === 0,\n                  onClick: handleBack,\n                  sx: {\n                    marginTop: theme.spacing(1),\n                    marginRight: theme.spacing(1)\n                  },\n                  children: \"Back\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 11\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  disabled: files.length === 0 || caption === \"\",\n                  variant: \"contained\",\n                  color: \"primary\",\n                  onClick: activeStep === steps.length - 1 ? handleSubmit : handleNext,\n                  sx: {\n                    marginTop: theme.spacing(1),\n                    marginRight: theme.spacing(1)\n                  },\n                  children: activeStep === steps.length - 1 ? \"Submit\" : \"Next\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 184,\n                  columnNumber: 11\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 10\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 8\n          }, this)]\n        }, label, true, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 7\n        }, this)), activeStep === steps.length && /*#__PURE__*/_jsxDEV(Paper, {\n          square: true,\n          elevation: 0,\n          sx: {\n            padding: \"6px 24px\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            sx: theme.finishStyle,\n            children: query === \"success\" ? /*#__PURE__*/_jsxDEV(Alert, {\n              variant: \"outlined\",\n              severity: \"success\",\n              children: \"Your post has been successfully submitted \\u2014 check it out!\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 10\n            }, this) : /*#__PURE__*/_jsxDEV(Fade, {\n              sx: theme.finishStyle,\n              in: query === \"progress\",\n              style: {\n                transitionDelay: query === \"progress\" ? \"100ms\" : \"0ms\"\n              },\n              unmountOnExit: true,\n              children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 11\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n\n_s(CreatePoste, \"a7/FR/8vBC0lliVj3e+OAGz2BsE=\", false, function () {\n  return [useTheme, useNavigate];\n});\n\n_c = CreatePoste;\nexport default CreatePoste;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreatePoste\");","map":{"version":3,"sources":["/home/soumyajit/Personal_Projects/topgram-app/frontend/src/screens/CreatePost.jsx"],"names":["React","useState","useEffect","useRef","useNavigate","Axios","CREATE_POST_URL","Navbar","Stepper","Step","StepLabel","StepContent","Button","Paper","Typography","TextField","CircularProgress","Fade","Alert","FilePond","registerPlugin","FilePondPluginImagePreview","FilePondPluginFileEncode","FilePondPluginImageResize","FilePondPluginImageTransform","FilePondPluginFileValidateType","useTheme","getSteps","CreatePoste","theme","history","files","setFiles","caption","setCaption","activeStep","setActiveStep","steps","query","setQuery","timerRef","clearTimeout","current","handlePostData","photoEncode","getFileEncodeBase64String","photoType","fileType","title","body","then","rep","getStepContent","step","filesContainer","margin","e","target","value","handleNext","prevActiveStep","handleBack","handleClickQuery","setTimeout","handleSubmit","width","map","label","index","actionsContainer","marginTop","spacing","marginRight","length","padding","finishStyle","transitionDelay"],"mappings":"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","sourcesContent":["\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Axios from \"axios\";\nimport { CREATE_POST_URL } from \"../service/apiCalls\";\nimport Navbar from \"../components/Navbar\";\n\n// Material-UI deps\nimport Stepper from \"@mui/material/Stepper\";\nimport Step from \"@mui/material/Step\";\nimport StepLabel from \"@mui/material/StepLabel\";\nimport StepContent from \"@mui/material/StepContent\";\nimport Button from \"@mui/material/Button\";\nimport Paper from \"@mui/material/Paper\";\nimport Typography from \"@mui/material/Typography\";\nimport TextField from \"@mui/material/TextField\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport Fade from \"@mui/material/Fade\";\nimport Alert from '@mui/material/Alert';\n// FilePond deps\nimport { FilePond, registerPlugin } from \"react-filepond\";\nimport \"filepond/dist/filepond.min.css\";\nimport FilePondPluginImagePreview from \"filepond-plugin-image-preview\";\nimport \"filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.css\";\nimport FilePondPluginFileEncode from \"filepond-plugin-file-encode\";\nimport FilePondPluginImageResize from \"filepond-plugin-image-resize\";\nimport FilePondPluginImageTransform from \"filepond-plugin-image-transform\";\nimport FilePondPluginFileValidateType from \"filepond-plugin-file-validate-type\";\nimport { useTheme } from \"@mui/system\";\n\nregisterPlugin(\n\tFilePondPluginImagePreview,\n\tFilePondPluginFileEncode,\n\tFilePondPluginImageResize,\n\tFilePondPluginImageTransform,\n\tFilePondPluginFileValidateType\n);\n\nconst getSteps = () => {\n\treturn [\"Select you image\", \"Tag a Friend\", \"Submit the post\"];\n};\n\nconst CreatePoste = () => {\n\tconst theme = useTheme();\n\tconst history = useNavigate();\n\tconst [files, setFiles] = useState([]);\n\tconst [caption, setCaption] = useState(\"\");\n\tconst [activeStep, setActiveStep] = useState(0);\n\tconst steps = getSteps();\n\n\tconst [query, setQuery] = useState(\"idle\");\n\tconst timerRef = useRef();\n\n\t// const config = axiosConfig(localStorage.getItem(\"jwt\"));\n\n\tuseEffect(\n\t\t() => () => {\n\t\t\tclearTimeout(timerRef.current);\n\t\t},\n\t\t[]\n\t);\n\n\tconst handlePostData = () => {\n\t\t// the Index 0 means the first file , we will add in the future the support of multiple\n\t\t// images upload , the max will be 10 images per post\n\t\tconst photoEncode = files[0].getFileEncodeBase64String();\n\t\tconst photoType = files[0].fileType;\n\t\t// Axios.post(\n\t\t// \tCREATE_POST_URL,\n\t\t// \t{\n\t\t// \t\ttitle: caption,\n\t\t// \t\tbody: caption,\n\t\t// \t\tphotoEncode,\n\t\t// \t\tphotoType,\n\t\t// \t},\n\t\t// \tconfig\n\t\t// ).then((rep) => {\n\t\t// \tif (rep.data.message) {\n\t\t// \t\tsetQuery(\"success\");\n\t\t// \t}\n\t\t// });\n\t\tCREATE_POST_URL({\n\t\t\ttitle: caption,\n\t\t\tbody: caption,\n\t\t\tphotoEncode,\n\t\t\tphotoType,\n\t\t})\n\t\t.then((rep) => {\n\t\t\tif (rep) {\n\t\t\t\tsetQuery(\"success\");\n\t\t\t}\n\t\t})\n\t\t;\n\t};\n\n\tconst getStepContent = (step) => {\n\t\tswitch (step) {\n\t\t\tcase 0:\n\t\t\t\treturn (\n\t\t\t\t\t<div sx={theme.filesContainer}>\n\t\t\t\t\t\t<FilePond\n\t\t\t\t\t\t\tlabelIdle='Drag & Drop your picture or <span class=\"filepond--label-action\">Browse</span>'\n\t\t\t\t\t\t\tfiles={files}\n\t\t\t\t\t\t\tallowMultiple={false}\n\t\t\t\t\t\t\tonupdatefiles={setFiles}\n\t\t\t\t\t\t\timageResizeTargetWidth={450}\n\t\t\t\t\t\t\timageResizeTargetHeight={450}\n\t\t\t\t\t\t\tacceptedFileTypes={[\"image/jpeg\", \"image/png\", \"images/gif\"]}\n\t\t\t\t\t\t\trequired={true}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tsx={{ margin: \"10px 0px\" }}\n\t\t\t\t\t\t\tid=\"outlined-search\"\n\t\t\t\t\t\t\tlabel=\"Caption\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tfullWidth=\"true\"\n\t\t\t\t\t\t\tmultiline=\"true\"\n\t\t\t\t\t\t\tvalue={caption}\n\t\t\t\t\t\t\tonChange={(e) => setCaption(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\tcase 1:\n\t\t\t\treturn \"This functionality isn't available for the moment\";\n\t\t\tcase 2:\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t\t\treturn \"Unknown step\";\n\t\t}\n\t};\n\n\tconst handleNext = () => {\n\t\tsetActiveStep((prevActiveStep) => prevActiveStep + 1);\n\t};\n\n\tconst handleBack = () => {\n\t\tsetActiveStep((prevActiveStep) => prevActiveStep - 1);\n\t};\n\n\tconst handleClickQuery = () => {\n\t\tclearTimeout(timerRef.current);\n\t\tif (query !== \"idle\") {\n\t\t\tsetQuery(\"idle\");\n\t\t\treturn;\n\t\t}\n\t\tsetQuery(\"progress\");\n\t\ttimerRef.current = setTimeout(() => {\n\t\t\thistory(\"/\");\n\t\t}, 4000);\n\t};\n\n\tconst handleSubmit = () => {\n\t\thandleNext();\n\t\thandleClickQuery();\n\t\thandlePostData();\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<Navbar />\n\t\t\t<div sx={{ \t\n\t\t\t\twidth: \"70%\",\n\t\t\t\tmargin: \"40px auto\"\n\t\t\t\t}}>\n\t\t\t\t<Stepper component={Paper} elevation={3} activeStep={activeStep} orientation=\"vertical\">\n\t\t\t\t\t{steps.map((label, index) => (\n\t\t\t\t\t\t<Step key={label}>\n\t\t\t\t\t\t\t<StepLabel>{label}</StepLabel>\n\t\t\t\t\t\t\t<StepContent>\n\t\t\t\t\t\t\t\t<Typography>{getStepContent(index)}</Typography>\n\t\t\t\t\t\t\t\t<div sx={theme.actionsContainer}>\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tdisabled={activeStep === 0}\n\t\t\t\t\t\t\t\t\t\t\tonClick={handleBack}\n\t\t\t\t\t\t\t\t\t\t\tsx={{\n\t\t\t\t\t\t\t\t\t\t\t\tmarginTop: theme.spacing(1),\n\t\t\t\t\t\t\t\t\t\t\t\tmarginRight: theme.spacing(1),\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tBack\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tdisabled={files.length === 0 || caption === \"\"}\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t\t\t\t\tactiveStep === steps.length - 1\n\t\t\t\t\t\t\t\t\t\t\t\t\t? handleSubmit\n\t\t\t\t\t\t\t\t\t\t\t\t\t: handleNext\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tsx={{\n\t\t\t\t\t\t\t\t\t\t\t\tmarginTop: theme.spacing(1),\n\t\t\t\t\t\t\t\t\t\t\t\tmarginRight: theme.spacing(1),\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{activeStep === steps.length - 1 ? \"Submit\" : \"Next\"}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</StepContent>\n\t\t\t\t\t\t</Step>\n\t\t\t\t\t))}\n\t\t\t\t\t{activeStep === steps.length && (\n\t\t\t\t\t\t<Paper square elevation={0} sx={{\n\t\t\t\t\t\t\tpadding: \"6px 24px\",\n\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t<div sx={theme.finishStyle}>\n\t\t\t\t\t\t\t\t{query === \"success\" ? (\n\t\t\t\t\t\t\t\t\t<Alert variant=\"outlined\" severity=\"success\">\n\t\t\t\t\t\t\t\t\t\tYour post has been successfully submitted â€” check it out!\n\t\t\t\t\t\t\t\t\t</Alert>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<Fade\n\t\t\t\t\t\t\t\t\t\tsx={theme.finishStyle}\n\t\t\t\t\t\t\t\t\t\tin={query === \"progress\"}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\ttransitionDelay:\n\t\t\t\t\t\t\t\t\t\t\t\tquery === \"progress\" ? \"100ms\" : \"0ms\",\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tunmountOnExit\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<CircularProgress />\n\t\t\t\t\t\t\t\t\t</Fade>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Paper>\n\t\t\t\t\t)}\n\t\t\t\t</Stepper>\n\t\t\t</div>\n\t\t</>\n\t);\n};\n\nexport default CreatePoste;\n"]},"metadata":{},"sourceType":"module"}